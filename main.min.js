/*!
 * Media Controls
 * YouTube-like Keyboard Controls for HTML Audio and Video
 * @author Chris Burnell <me@chrisburnell.com>
 * @version 1.1.2
 */(()=>{'use strict';const mediaElements=document.querySelectorAll("audio, video");if(!!mediaElements.length){function keyMap(physicalKey,action){this.physicalKey=physicalKey,this.action=action}function rangeMap(value,oldMinimum,oldMaximum,newMinimum,newMaximum){return newMinimum+(newMaximum-newMinimum)*(value-oldMinimum)/(oldMaximum-oldMinimum)}let currentTime,duration,volume,playbackRate,keyCode,keyData,media=mediaElements[0]?mediaElements[0]:void 0;for(let mediaElement of mediaElements)["focus","play","pause","seeking","seeked","volumechange"].forEach(event=>{mediaElement.addEventListener(event,()=>{media=mediaElement})});const keys={32:new keyMap("spacebar","play-pause"),75:new keyMap("k","play-pause"),37:new keyMap("\u25C0","rewind-5"),39:new keyMap("\u25B6","forward-5"),74:new keyMap("j","rewind-10"),76:new keyMap("l","forward-10"),34:new keyMap("pagedown","rewind-30"),33:new keyMap("pageup","forward-30"),38:new keyMap("\u25B2","volume-up"),40:new keyMap("\u25BC","volume-down"),77:new keyMap("m","mute-unmute"),68:new keyMap("d","speed-up"),187:new keyMap("=","speed-up"),65:new keyMap("a","speed-down"),189:new keyMap("-","speed-down"),83:new keyMap("s","speed-default"),48:new keyMap("0","speed-default"),36:new keyMap("home","start"),35:new keyMap("end","end")},numberKeys=Array(9).fill().map((_,index)=>49+index);// 1–9
for(let numberKey in numberKeys)keys[numberKeys[numberKey]]=new keyMap(numberKey,"seek");// Num1–Num9
const numpadKeys=Array(9).fill().map((_,index)=>97+index);for(let numpadKey in numpadKeys)keys[numpadKeys[numpadKey]]=new keyMap(numpadKey,"seek");const actions={"play-pause":()=>{media.paused?media.play():media.pause()},"rewind-5":()=>{media.currentTime=5>currentTime?0:currentTime-5},"forward-5":()=>{media.currentTime=5>duration-currentTime?duration:currentTime+5},"rewind-10":()=>{media.currentTime=10>currentTime?0:currentTime-10},"forward-10":()=>{media.currentTime=10>duration-currentTime?duration:currentTime+10},"rewind-30":()=>{media.currentTime=30>currentTime?0:currentTime-30},"forward-30":()=>{media.currentTime=30>duration-currentTime?duration:currentTime+30},"volume-down":()=>{media.volume=.05>=volume?0:+(volume-.05).toFixed(2)},"volume-up":()=>{media.volume=.95<=volume?1:+(volume+.05).toFixed(2)},"mute-unmute":()=>{media.muted=!media.muted},"speed-down":()=>{media.playbackRate=.25==playbackRate?.25:+(playbackRate-.25).toFixed(2)},"speed-up":()=>{media.playbackRate=2==playbackRate?2:+(playbackRate+.25).toFixed(2)},"speed-default":()=>{media.playbackRate=1},start:()=>{media.currentTime=0},end:()=>{media.currentTime=duration},seek:key=>{media.currentTime=rangeMap(parseInt(key),0,8,0,duration)}};window.addEventListener("keydown",event=>{event.defaultPrevented||event.metaKey||event.ctrlKey||event.shiftKey||(keyCode=event.keyCode?event.keyCode:event.which,currentTime=media.currentTime,duration=media.duration,volume=media.volume,playbackRate=media.playbackRate,keyData=Object.keys(keys).filter(key=>key==keyCode).reduce((_,key)=>keys[key],void 0),keyData!==void 0&&(event.stopPropagation(),event.preventDefault(),actions[keyData.action](keyData.physicalKey)))})}})();